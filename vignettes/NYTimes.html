<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ryan Kuhn" />


<title>NY Time Blog Analysis</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">NY Time Blog Analysis</h1>
<h4 class="author"><em>Ryan Kuhn</em></h4>
<h4 class="date"><em>July 7, 2016</em></h4>



<div id="setup-the-environment-and-load-the-data" class="section level4">
<h4>Setup the environment and load the data</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tm)
<span class="kw">library</span>(rpart)
<span class="kw">library</span>(rpart.plot)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(caTools)
<span class="kw">library</span>(ROCR)
<span class="kw">library</span>(caret)
<span class="kw">library</span>(randomForest)
<span class="kw">library</span>(gbm)
<span class="kw">library</span>(NYTimes)

<span class="kw">data</span>(trainingset)
<span class="kw">data</span>(testingset)

train&lt;-<span class="st"> </span>trainingset
test &lt;-<span class="st"> </span>testingset</code></pre></div>
</div>
<div id="data-cleaning" class="section level3">
<h3>Data Cleaning</h3>
<div id="setting-factors" class="section level4">
<h4>Setting factors</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lvls&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Business&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;Culture&quot;</span>,<span class="st">&quot;Foreign&quot;</span>, <span class="st">&quot;Magazine&quot;</span>,<span class="st">&quot;Metro&quot;</span>,<span class="st">&quot;OpEd&quot;</span>, <span class="st">&quot;Science&quot;</span>,<span class="st">&quot;Sports&quot;</span>,<span class="st">&quot;Styles&quot;</span>, <span class="st">&quot;Travel&quot;</span>,<span class="st">&quot;TStyle&quot;</span>,<span class="st">&quot;National&quot;</span>)

train$NewsDesk&lt;-<span class="st"> </span><span class="kw">factor</span>(train$NewsDesk, <span class="dt">levels=</span>lvls)
test$NewsDesk &lt;-<span class="st"> </span><span class="kw">factor</span>(test$NewsDesk, <span class="dt">levels=</span>lvls)


train$SectionName   &lt;-<span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(train$SectionName),<span class="st">&quot;Business Day&quot;</span>)
train$SubsectionName&lt;-<span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(train$SubsectionName), <span class="st">&quot;Dealbook&quot;</span>)

test$SectionName   &lt;-<span class="st"> </span><span class="kw">factor</span>(test$SectionName, <span class="dt">levels=</span><span class="kw">levels</span>(train$SectionName))
test$SubsectionName&lt;-<span class="st"> </span><span class="kw">factor</span>(test$SubsectionName, <span class="dt">levels=</span><span class="kw">levels</span>(train$SubsectionName))


train$PubDate&lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(train$PubDate,<span class="dt">format=</span> <span class="st">&quot;%Y-%m-%e&quot;</span>)
train$wkday  &lt;-<span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(<span class="kw">weekdays</span>(train$PubDate)),<span class="st">&quot;Friday&quot;</span>)

test$PubDate&lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(test$PubDate,<span class="dt">format=</span><span class="st">&quot;%Y-%m-%e&quot;</span>)
test$wkday  &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">weekdays</span>(test$PubDate), <span class="dt">levels=</span><span class="kw">levels</span>(train$wkday))</code></pre></div>
</div>
<div id="formatting-headlines" class="section level4">
<h4>Formatting headlines</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Questions &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;?&quot;</span>, train$Headline, <span class="dt">fixed=</span>T)
QnA       &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Q. and A.&quot;</span>, train$Headline, <span class="dt">fixed=</span>T)
Gift      &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;The Daily Gift&quot;</span>, train$Headline, <span class="dt">fixed=</span>T)
Clip      &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Daily Clip Report&quot;</span>, train$Headline, <span class="dt">fixed=</span>T)
Recap     &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Recap&quot;</span>,train$Headline, <span class="dt">fixed=</span>T)

train$type            &lt;-<span class="st">&quot;None&quot;</span>
train$type[QnA]       &lt;-<span class="st">&quot;QnA&quot;</span>
train$type[Questions] &lt;-<span class="st">&quot;Question&quot;</span>
train$type[Gift]      &lt;-<span class="st">&quot;Gift&quot;</span>
train$type[Clip]      &lt;-<span class="st">&quot;Clip&quot;</span>
train$type[Recap]     &lt;-<span class="st">&quot;Recap&quot;</span>
train$type&lt;-<span class="st"> </span><span class="kw">factor</span>(train$type, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;None&quot;</span>,<span class="st">&quot;Question&quot;</span>,<span class="st">&quot;Gift&quot;</span>,<span class="st">&quot;Clip&quot;</span>,<span class="st">&quot;QnA&quot;</span>,<span class="st">&quot;Recap&quot;</span>))



Questions &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;?&quot;</span>, test$Headline, <span class="dt">fixed=</span>T)
QnA       &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Q. and A.&quot;</span>, test$Headline, <span class="dt">fixed=</span>T)
Gift      &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;The Daily Gift&quot;</span>, test$Headline, <span class="dt">fixed=</span>T)
Clip      &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Daily Clip Report&quot;</span>, test$Headline, <span class="dt">fixed=</span>T)
Recap     &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;Recap&quot;</span>,test$Headline, <span class="dt">fixed=</span>T)

test$type            &lt;-<span class="st">&quot;None&quot;</span>
test$type[QnA]       &lt;-<span class="st">&quot;QnA&quot;</span>
test$type[Questions] &lt;-<span class="st">&quot;Question&quot;</span>
test$type[Gift]      &lt;-<span class="st">&quot;Gift&quot;</span>
test$type[Clip]      &lt;-<span class="st">&quot;Clip&quot;</span>
test$type[Recap]     &lt;-<span class="st">&quot;Recap&quot;</span>
test$type&lt;-<span class="st"> </span><span class="kw">factor</span>(test$type, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;None&quot;</span>,<span class="st">&quot;Question&quot;</span>,<span class="st">&quot;Gift&quot;</span>,<span class="st">&quot;Clip&quot;</span>,<span class="st">&quot;QnA&quot;</span>,<span class="st">&quot;Recap&quot;</span>))</code></pre></div>
</div>
</div>
<div id="modeling" class="section level3">
<h3>Modeling</h3>
<div id="split-the-training-dataset" class="section level4">
<h4>Split the training dataset</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">split&lt;-<span class="st"> </span><span class="kw">sample.split</span>(train$Popular, <span class="dt">SplitRatio=</span>.<span class="dv">7</span>)

Ttrain&lt;-<span class="st"> </span><span class="kw">subset</span>(train, split==<span class="ot">TRUE</span>)
Ttest &lt;-<span class="st"> </span><span class="kw">subset</span>(train, split==<span class="ot">FALSE</span>)
<span class="kw">rm</span>(split)</code></pre></div>
</div>
<div id="baseline-model" class="section level4">
<h4>Baseline model</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ttrain %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(Popular) %&gt;%
<span class="st">  </span><span class="kw">select</span>(Popular) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">N=</span><span class="kw">n</span>())

Base&lt;-<span class="dv">3807</span>/<span class="kw">nrow</span>(Ttrain)
BasePred&lt;-<span class="kw">rep</span>(Base,<span class="kw">nrow</span>(Ttest))

ROCRpred&lt;-<span class="kw">prediction</span>(BasePred,Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## # A tibble: 2 × 2
##   Popular     N
##     &lt;int&gt; &lt;int&gt;
## 1       0  3807
## 2       1   765</code></pre>
<p>Baseline percentage is 83% Base AUC score is is 0.5</p>
</div>
<div id="logistic-regression" class="section level4">
<h4>Logistic Regression</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LogMdl&lt;-<span class="st"> </span><span class="kw">glm</span>(Popular~.,<span class="dt">data=</span>Ttrain[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)], <span class="dt">family=</span>binomial)
PredLog&lt;-<span class="kw">predict</span>(LogMdl,<span class="dt">newdata=</span>Ttest[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)],<span class="dt">type=</span><span class="st">&quot;response&quot;</span>)


ROCRpred&lt;-<span class="kw">prediction</span>(PredLog,Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AUC score is 0.878</p>
</div>
<div id="clustering" class="section level4">
<h4>Clustering</h4>
<p><em>Except…</em> clustering is doesn’t work for predictions. You’d have to do seperate models for each cluster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Tcluster&lt;-Ttrain[,<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">11</span>)]
Tcluster$time&lt;-<span class="kw">scale</span>(Ttrain$WordCount)

Tdummies&lt;-<span class="kw">dummyVars</span>(Popular~.,<span class="dt">data=</span>Tcluster)
Tdumb&lt;-<span class="kw">predict</span>(Tdummies,<span class="dt">newdata=</span>Tcluster)

Dist&lt;-<span class="kw">dist</span>(Tdumb,<span class="dt">method=</span><span class="st">&quot;euclidean&quot;</span>)
clusters&lt;-<span class="kw">hclust</span>(Dist,<span class="dt">method=</span><span class="st">&quot;ward.D&quot;</span>)
<span class="kw">plot</span>(clusters, <span class="dt">axes=</span>F, <span class="dt">labels=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clusterGroups&lt;-<span class="kw">cutree</span>(clusters,<span class="dt">k=</span><span class="dv">3</span>)
clusterGroups&lt;-<span class="kw">data.frame</span>(<span class="dt">clusters=</span><span class="kw">matrix</span>(clusterGroups,<span class="dt">ncol=</span><span class="dv">1</span>))


clustdummies&lt;-<span class="kw">dummyVars</span>(clusters~.,<span class="dt">data=</span>clusterGroups)
clusterGroupsdumb&lt;-<span class="kw">as.data.frame</span>(<span class="kw">predict</span>(clustdummies,<span class="dt">newdata=</span>clusterGroups))</code></pre></div>
</div>
</div>
<div id="text-analytics" class="section level3">
<h3>Text Analytics</h3>
<div id="prepare-the-training-set" class="section level4">
<h4>Prepare the training set</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TrainCorpus&lt;-<span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(Ttrain$Abstract))
TrainCorpus&lt;-<span class="kw">tm_map</span>(TrainCorpus,<span class="kw">content_transformer</span>(tolower))
TrainCorpus&lt;-<span class="kw">tm_map</span>(TrainCorpus, PlainTextDocument)
TrainCorpus&lt;-<span class="kw">tm_map</span>(TrainCorpus,removePunctuation)
TrainCorpus&lt;-<span class="kw">tm_map</span>(TrainCorpus,stemDocument)
TrainCorpus&lt;-<span class="kw">tm_map</span>(TrainCorpus,removeWords, 
                    <span class="kw">c</span>(<span class="st">&quot;2015&quot;</span>,<span class="st">&quot;about&quot;</span>,
                      <span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>)))

dtmTrain&lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(TrainCorpus)

sparseTrain&lt;-<span class="kw">removeSparseTerms</span>(dtmTrain,<span class="fl">0.98</span>)

wordsTrain&lt;-<span class="kw">as.data.frame</span>(<span class="kw">inspect</span>(sparseTrain))
Targets&lt;-<span class="kw">colnames</span>(wordsTrain)
<span class="kw">colnames</span>(wordsTrain) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">colnames</span>(wordsTrain),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)

TextTrain&lt;-<span class="kw">data.frame</span>(wordsTrain,Ttrain$Popular, <span class="dt">row.names=</span><span class="ot">NULL</span>)</code></pre></div>
</div>
<div id="prepare-test-set" class="section level4">
<h4>Prepare test set</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TestCorpus&lt;-<span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(Ttest$Abstract))
TestCorpus&lt;-<span class="kw">tm_map</span>(TestCorpus,<span class="kw">content_transformer</span>(tolower))
TestCorpus&lt;-<span class="kw">tm_map</span>(TestCorpus, PlainTextDocument)
TestCorpus&lt;-<span class="kw">tm_map</span>(TestCorpus,removePunctuation)
TestCorpus&lt;-<span class="kw">tm_map</span>(TestCorpus,removeWords,<span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>))
TestCorpus&lt;-<span class="kw">tm_map</span>(TestCorpus,stemDocument)
dtmTest&lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(TestCorpus)

wordsTest&lt;-<span class="kw">inspect</span>(dtmTest[,<span class="kw">colnames</span>(dtmTest) %in%<span class="st"> </span>Targets])
<span class="kw">colnames</span>(wordsTest) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">colnames</span>(wordsTest),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
TextTest&lt;-<span class="kw">data.frame</span>(wordsTest,Ttest$Popular,<span class="dt">row.names=</span><span class="ot">NULL</span>)</code></pre></div>
</div>
<div id="prepare-the-model" class="section level4">
<h4>Prepare the model</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TextLogMdl&lt;-<span class="kw">glm</span>(Ttrain.Popular~.,<span class="dt">data=</span>TextTrain,<span class="dt">family=</span>binomial)

TextLogPred&lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(TextLogMdl,<span class="dt">newdata=</span>TextTest,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>))

<span class="kw">table</span>(Ttest$Popular,TextLogPred&gt;.<span class="dv">5</span>)
<span class="kw">table</span>(train$Popular)

ROCRpred&lt;-<span class="st"> </span><span class="kw">prediction</span>(TextLogPred,Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AUC score is 0.717</p>
</div>
<div id="train-cart" class="section level4">
<h4>Train CART</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CART&lt;-<span class="st"> </span><span class="kw">rpart</span>(Popular~.,<span class="dt">data=</span>Ttrain[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)], 
             <span class="dt">method=</span><span class="st">&quot;class&quot;</span>,           
             <span class="dt">na.action=</span>na.rpart,
             <span class="dt">control=</span><span class="kw">rpart.control</span>(<span class="dt">xval=</span><span class="dv">10</span>,<span class="dt">cp=</span><span class="fl">0.05</span>,<span class="dt">minbucket=</span><span class="dv">10</span>))

CART&lt;-<span class="kw">prune</span>(CART,<span class="dt">cp=</span><span class="fl">0.05</span>)

<span class="kw">prp</span>(CART, 
    <span class="dt">main=</span> <span class="st">&quot;RAOP Classification Tree&quot;</span>,
    <span class="dt">extra=</span><span class="dv">1</span>,
    <span class="dt">box.col=</span><span class="kw">c</span>(<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;palegreen&quot;</span>)[CART$frame$yval],
    <span class="dt">leaf.round=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CARTPred&lt;-<span class="st"> </span><span class="kw">predict</span>(CART,<span class="dt">newdata=</span>Ttest[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)], <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>)

ROCRpred&lt;-<span class="st"> </span><span class="kw">prediction</span>(CARTPred[,<span class="dv">2</span>],Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AUC score is 0.716 and is not an improvement over the GLM model.</p>
</div>
<div id="train-random-forest" class="section level4">
<h4>Train Random Forest</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Forest&lt;-<span class="st"> </span><span class="kw">randomForest</span>(<span class="kw">as.factor</span>(Popular)~.,
                      <span class="dt">data=</span>Ttrain[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)],
                      <span class="dt">nodesize=</span><span class="dv">5</span>)

ForestPred&lt;-<span class="kw">predict</span>(Forest,
                    <span class="dt">newdata=</span>Ttest[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">12</span>)], 
                    <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>,
                    <span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)

ROCRpred&lt;-<span class="st"> </span><span class="kw">prediction</span>(ForestPred[,<span class="dv">2</span>],Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ForestPred2&lt;-<span class="kw">predict</span>(Forest,<span class="dt">newdata=</span>test[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>)], <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>,<span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)</code></pre></div>
<p>AUC score is 0.879 and is not an improvement over the GLM model.</p>
</div>
<div id="random-forest-using-text-analytics" class="section level4">
<h4>Random Forest Using Text Analytics</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TtrainComb&lt;-<span class="st"> </span><span class="kw">data.frame</span>(TextTrain, Ttrain[,<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">7</span>:<span class="dv">8</span>,<span class="dv">11</span>:<span class="dv">12</span>)])

ForestComb&lt;-<span class="st"> </span><span class="kw">randomForest</span>(<span class="kw">as.factor</span>(Ttrain.Popular)~.,
                          <span class="dt">data=</span>TtrainComb,
                          <span class="dt">nodesize=</span><span class="dv">5</span>)

TtestComb&lt;-<span class="st"> </span><span class="kw">data.frame</span>(TextTest, Ttest[,<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">7</span>:<span class="dv">9</span>,<span class="dv">11</span>:<span class="dv">12</span>)])

ForestPredComb&lt;-<span class="kw">predict</span>(ForestComb,
                        <span class="dt">newdata=</span>TtestComb,
                        <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>,
                        <span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)

ROCRpred&lt;-<span class="st"> </span><span class="kw">prediction</span>(ForestPredComb[,<span class="dv">2</span>],Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AUC score is 0.925- best model yet!</p>
</div>
<div id="train-ensembling" class="section level4">
<h4>Train ensembling</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AUCs&lt;-<span class="kw">c</span>(.<span class="dv">8756</span>,.<span class="dv">7048</span>,.<span class="dv">7249</span>,.<span class="dv">8811</span>,.<span class="dv">9453</span>)
Predictions&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">GLM=</span>PredLog,
                         <span class="dt">Text=</span>TextLogPred, 
                         <span class="dt">CART=</span>CARTPred[,<span class="dv">2</span>],
                         <span class="dt">Forest=</span>ForestPred[,<span class="dv">2</span>],
                         <span class="dt">Comb=</span>ForestPredComb[,<span class="dv">2</span>])
weights&lt;-<span class="kw">c</span>(.<span class="dv">20</span>,.<span class="dv">20</span>,.<span class="dv">20</span>,.<span class="dv">20</span>,.<span class="dv">20</span>)
weightedPred&lt;-Predictions*weights
Temp&lt;-<span class="st"> </span><span class="kw">rowSums</span>(weightedPred,<span class="dt">na.rm=</span>T)

ROCRpred&lt;-<span class="st"> </span><span class="kw">prediction</span>(Temp,Ttest$Popular)
ROCRperf&lt;-<span class="st"> </span><span class="kw">performance</span>(ROCRpred,<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(ROCRperf)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AUC score is 0.91</p>
</div>
<div id="test-nlp" class="section level4">
<h4>Test NLP</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TestCorpus2&lt;-<span class="kw">Corpus</span>(<span class="kw">VectorSource</span>(test$Abstract))
TestCorpus2&lt;-<span class="kw">tm_map</span>(TestCorpus2, <span class="kw">content_transformer</span>(tolower))
TestCorpus2&lt;-<span class="kw">tm_map</span>(TestCorpus2, PlainTextDocument)
TestCorpus2&lt;-<span class="kw">tm_map</span>(TestCorpus2, removePunctuation)
TestCorpus2&lt;-<span class="kw">tm_map</span>(TestCorpus2, removeWords,<span class="kw">stopwords</span>(<span class="st">&quot;english&quot;</span>))
TestCorpus2&lt;-<span class="kw">tm_map</span>(TestCorpus2, stemDocument)
dtmTest2&lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(TestCorpus2)

wordsTest2&lt;-<span class="kw">inspect</span>(dtmTest2[,<span class="kw">colnames</span>(dtmTest2) %in%<span class="st"> </span>Targets])
<span class="kw">colnames</span>(wordsTest2) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">colnames</span>(wordsTest2),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
TextTest2&lt;-<span class="kw">data.frame</span>(wordsTest2,<span class="dt">row.names=</span><span class="ot">NULL</span>)</code></pre></div>
</div>
<div id="test-random-forest-2" class="section level4">
<h4>Test Random Forest 2</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TtestComb2&lt;-<span class="st"> </span><span class="kw">data.frame</span>(TextTest2, test[,<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">7</span>:<span class="dv">8</span>,<span class="dv">10</span>:<span class="dv">11</span>)])


<span class="co"># Test Predictions ----</span>

PredLog2        &lt;-<span class="st"> </span><span class="kw">predict</span>(LogMdl,
                           <span class="dt">newdata=</span>test[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>)],
                           <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
TextLogPred2    &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(TextLogMdl,<span class="dt">newdata=</span>TextTest2,<span class="dt">type=</span><span class="st">&quot;response&quot;</span>))
CARTPred2       &lt;-<span class="st"> </span><span class="kw">predict</span>(CART,  
                           <span class="dt">newdata=</span>test[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>)], 
                           <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>)
ForestPred2     &lt;-<span class="st"> </span><span class="kw">predict</span>(Forest,
                           <span class="dt">newdata=</span>test[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>)], 
                           <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>,
                           <span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)
ForestPredComb2 &lt;-<span class="st"> </span><span class="kw">predict</span>(ForestComb,
                           <span class="dt">newdata=</span>TtestComb2,
                           <span class="dt">type=</span><span class="st">&quot;prob&quot;</span>,
                           <span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)</code></pre></div>
</div>
<div id="weight-the-models" class="section level4">
<h4>Weight the Models</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Predictions2&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">GLM=</span>PredLog2,
                          <span class="dt">Text=</span>TextLogPred2, 
                          <span class="dt">CART=</span>CARTPred2[,<span class="dv">2</span>], 
                          <span class="dt">Forest=</span>ForestPred2[,<span class="dv">2</span>],
                          <span class="dt">Comb=</span>ForestPredComb2[,<span class="dv">2</span>])
weightedPred2&lt;-Predictions2*weights
Temp2&lt;-<span class="st"> </span><span class="kw">rowSums</span>(weightedPred2,<span class="dt">na.rm=</span>T)


Submit2&lt;-<span class="kw">data.frame</span>(<span class="dt">UniqueID=</span>test$UniqueID,<span class="dt">Probability1=</span>Temp2)

<span class="co"># Just RandomForestComn</span>
Submit2&lt;-<span class="kw">data.frame</span>(<span class="dt">UniqueID=</span>test$UniqueID,<span class="dt">Probability1=</span>ForestPredComb2[,<span class="dv">2</span>])</code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
